<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
	<link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
	<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
	<script src="https://cdn.jsdelivr.net/npm/vue@2.7.14"></script>
	<script src="https://unpkg.com/element-ui/lib/index.js"></script>
	<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.4.2/mapbox-gl-draw.js'></script>
	<link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.4.2/mapbox-gl-draw.css'
		type='text/css' />
</head>

<body>
	<style>
		html,
		body,
		#app {
			height: 100%;
			width: 100%;
			overflow: hidden;
			position: relative;
		}

		#map {
			width: 99%;
			height: 99%;
		}

		.ctrlPanel {
			position: absolute;
			border-radius: 8px;
			left: 10px;
			top: 10px;
			padding: 8px;
			background-color: rgba(255, 255, 255, 0.25);
			backdrop-filter: blur(6px);
			-webkit-backdrop-filter: blur(6px);
			border: 1px solid rgba(255, 255, 255, 0.18);
			box-shadow: rgba(142, 142, 142, 0.19) 0px 6px 15px 0px;
			-webkit-box-shadow: rgba(142, 142, 142, 0.19) 0px 6px 15px 0px;
			border-radius: 12px;
			-webkit-border-radius: 12px;
			color: rgba(255, 255, 255, 0.75);
			width: 280px;
			height: 500px;
		}

		.panelItem {
			margin-bottom: 5px;
			width: 100%;
		}

		.mybuttons {
			display: flex;
			justify-content: space-between;
		}
	</style>
	<div id="app">
		<div id="map"></div>
		<div class="ctrlPanel">
			<div class="panelItem">
				<el-input class="panelItem" size="mini" placeholder="输入经纬度 用英文逗号,隔开" v-model="lnglatStr"></el-input>
				<el-button class="panelItem" size="mini" @click="locate">定位</el-button>
			</div>
			<div class="panelItem">
				<el-input class="panelItem" size="mini" placeholder="输入合法的 mapbox style" v-model="lnglatStr"></el-input>
				<el-button class="panelItem" size="mini" @click="locate">替换 Style</el-button>
			</div>
			<div class="panelItem">
				<el-input class="panelItem" size="mini" placeholder="输入合法的 geojson 数据" v-model="lnglatStr"></el-input>
				<el-button class="panelItem" size="mini" @click="locate">绘制</el-button>
			</div>

			<!-- <div class="panelItem mybuttons">
				<el-button size="mini" @click="drawPoint">画点</el-button>
				<el-button size="mini" @click="drawLine">画线</el-button>
				<el-button size="mini" @click="drawPolygon">画面</el-button>
				<el-button size="mini" @click="clearDraw">清除</el-button>
			</div> -->

		</div>
	</div>
	<script>
		let map = null
		new Vue({
			el: '#app',
			data: function () {
				return {
					visible: false, lnglatStr: ''
				}
			},
			methods: {
				drawPoint() {

				},
				drawLine() {

				},
				drawPolygon() {

				},
				clearDraw() {

				},
				locate(e) {
					console.log(e);
					try {
						let point = this.lnglatStr.split(',')
						map.flyTo({
							center: point
						})
					} catch (error) {
						this.$notify({
							title: '输入非法！',
							message: error
						});
					}
				},
			},
			mounted() {
				mapboxgl.accessToken = 'pk.eyJ1IjoibmluZ2x4IiwiYSI6ImNsYnlnM2s2ODBnNmIzcHBpbzY5aDh3bHAifQ.hQL4zLjBss5i4x-zuFp9tg';
				map = new mapboxgl.Map({
					container: 'map', // container ID
					style: 'mapbox://styles/mapbox/streets-v12', // style URL
					center: [110.70727046509603, 33.05124063231834], // starting position [lng, lat]
					zoom: 2, // starting zoom
				});
				var draw = new MapboxDraw({
					displayControlsDefault: false,
					controls: {
						polygon: true,
						line_string: true,
						point: true,
						trash: true
					}
				});
				map.addControl(draw);
				map.on('load', () => {
					map.on('click', (e) => {
						console.log(e.lngLat)
					})
				})
				map.on('style.load', () => {

				})
			}
		})

	</script>
	</div>
</body>

</html>